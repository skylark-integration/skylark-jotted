/**
 * skylark-jotted - A version of jotted( html/css/js playground) that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jotted/
 * @license MIT
 */
!function(t,e){var n=e.define,s=e.require,i="function"==typeof n&&n.amd,r=!i&&"undefined"!=typeof exports;if(!i&&!n){var o={};n=e.define=function(t,e,n){"function"==typeof n?(o[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),s=t.split("/");n.pop();for(var i=0;i<s.length;i++)"."!=s[i]&&(".."==s[i]?n.pop():n.push(s[i]));return n.join("/")}(e,t)}),resolved:!1,exports:null},s(t)):o[t]={factory:null,resolved:!0,exports:n}},s=e.require=function(t){if(!o.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var n=o[t];if(!n.resolved){var i=[];n.deps.forEach(function(t){i.push(s(t))}),n.exports=n.factory.apply(e,i)||null,n.resolved=!0}return n.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,e){t("skylark-langx/_attach",[],function(){return function(t,e,n){"string"==typeof e&&(e=e.split("."));for(var s=e.length,i=t,r=0,o=e[r++];r<s;)i=i[o]=i[o]||{},o=e[r++];return i[o]=n}}),t("skylark-langx/skylark",["./_attach"],function(t){var e={attach:function(n,s){return t(e,n,s)}};return e}),t("skylark-jotted/util",[],function(){"use strict";function t(t={},e={}){var n={};return Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(s){void 0!==n[s]?n[s]=t[s]:n[s]=e[s]}),n}function e(t,n,s,i,r){s[t](n,function(t,n,s,i,r){return function(n,o){n&&i.push(n),++t<s.length?e(t,o,s,i,r):r(i,o)}}.apply(this,arguments))}function n(t,e){if(!t.className)return!1;var n=" "+t.className+" ";return e=" "+e+" ",-1!==n.indexOf(e)}var s={html:"html",css:"css",js:"javascript",less:"less",styl:"stylus",coffee:"coffeescript"};return{extend:t,fetch:function(t,e){var n=new window.XMLHttpRequest;n.open("GET",t),n.responseType="text",n.onload=function(){200===n.status?e(null,n.responseText):e(t,n)},n.onerror=function(t){e(t)},n.send()},seq:function(t,n,s=function(){}){var i=[];if(!t.length)return s(i,n);e(0,n,t,i,s)},debounce:function(t,e){var n=null,s=null;return function(){n?s=!0:t.apply(this,arguments),clearTimeout(n),n=setTimeout(()=>{s&&t.apply(this,arguments),n=null,s=null},e)}},log:function(){console.log(arguments)},getMode:function(e="",n="",i={}){var r=t(i,s);for(let t in r){let e=t.length;if(n.slice(-e++)==="."+t)return r[t]}for(let t in r)if(e===t)return r[t];return e},data:function(t,e){return t.getAttribute("data-"+e)},hasClass:n,addClass:function(t,e){if(n(t,e))return t.className;t.className&&(e=" "+e);return t.className+=e,t.className},removeClass:function(t,e){var n=" "+e,s=e+" ";-1!==t.className.indexOf(n)?t.className=t.className.replace(n,""):-1!==t.className.indexOf(s)?t.className=t.className.replace(s,""):t.className=t.className.replace(e,"");return t.className}}}),t("skylark-jotted/template",[],function(){"use strict";return{container:function(){return'\n    <ul class="jotted-nav">\n      <li class="jotted-nav-item jotted-nav-item-result">\n        <a href="#" data-jotted-type="result">\n          Result\n        </a>\n      </li>\n      <li class="jotted-nav-item jotted-nav-item-html">\n        <a href="#" data-jotted-type="html">\n          HTML\n        </a>\n      </li>\n      <li class="jotted-nav-item jotted-nav-item-css">\n        <a href="#" data-jotted-type="css">\n          CSS\n        </a>\n      </li>\n      <li class="jotted-nav-item jotted-nav-item-js">\n        <a href="#" data-jotted-type="js">\n          JavaScript\n        </a>\n      </li>\n    </ul>\n    <div class="jotted-pane jotted-pane-result"><iframe></iframe></div>\n    <div class="jotted-pane jotted-pane-html"></div>\n    <div class="jotted-pane jotted-pane-css"></div>\n    <div class="jotted-pane jotted-pane-js"></div>\n  '},paneActiveClass:function(t){return`jotted-pane-active-${t}`},containerClass:function(){return"jotted"},hasFileClass:function(t){return`jotted-has-${t}`},editorClass:function(t){return`jotted-editor jotted-editor-${t}`},editorContent:function(t,e=""){return`\n    <textarea data-jotted-type="${t}" data-jotted-file="${e}"></textarea>\n    <div class="jotted-status"></div>\n  `},statusMessage:function(t){return`\n    <p>${t}</p>\n  `},statusClass:function(t){return`jotted-status-${t}`},statusActiveClass:function(t){return`jotted-status-active-${t}`},pluginClass:function(t){return`jotted-plugin-${t}`},statusLoading:function(t){return`Loading <strong>${t}</strong>..`},statusFetchError:function(t){return`There was an error loading <strong>${t}</strong>.`}}}),t("skylark-jotted/plugin",["./util","./template"],function(t,e){"use strict";var n=[];return{register:function(t,e){e._id=t,n.push(e)},init:function(){this._get("options").plugins.forEach(s=>{let i,r,o={};"string"==typeof s?r=s:"object"==typeof s&&(r=s.name,o=s.options||{}),i=function(t){for(let e in n){let s=n[e];if(s._id===t)return s}throw new Error(`Plugin ${t} is not registered.`)}(r),this._get("plugins")[s]=new i(this,o),t.addClass(this._get("$container"),e.pluginClass(r))})}}}),t("skylark-jotted/pubsoup",["./util"],function(t){"use strict";return class{constructor(){this.topics={},this.callbacks={}}find(t){return this.topics[t]=this.topics[t]||[],this.topics[t]}subscribe(t,e,n=90){var s=this.find(t);e._priority=n,s.push(e),s.sort(function(t,e){return t._priority>e._priority?1:e._priority>t._priority?-1:0})}remover(t,e){t.forEach(function(){if(e){var n=[].indexOf.call(t,e);-1!==n&&t.splice(n,1)}else t.length=0})}unsubscribe(t,e){var n=this.find(t);this.remover(n,e),this.callbacks[t]=this.callbacks[t]||[],this.remover(this.callbacks[t],e)}publish(e,n={}){var s=this.find(e),i=[];s.forEach(function(t){i.push(t)}),t.seq(i,n,this.runCallbacks(e))}runCallbacks(t){return(e,n)=>{this.callbacks[t]=this.callbacks[t]||[],this.callbacks[t].forEach(t=>{t(e,n)})}}done(t,e=function(){}){this.callbacks[t]=this.callbacks[t]||[],this.callbacks[t].push(e)}}}),t("skylark-jotted/plugins/render",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{});var s=!!("srcdoc"in document.createElement("iframe")),i=e.$container.querySelector(".jotted-pane-result iframe");window.addEventListener("message",this.domready.bind(this)),e.on("change",this.change.bind(this),100),this.supportSrcdoc=s,this.content={html:"",css:"",js:""},this.frameContent="",this.$resultFrame=i,this.callbacks=[],this.index=0,this.lastCallback=(()=>{})}template(t="",e="",n=""){return`\n      <!doctype html>\n      <html>\n        <head>\n          <script>\n            (function () {\n              window.addEventListener('DOMContentLoaded', function () {\n                window.parent.postMessage(JSON.stringify({\n                  type: 'jotted-dom-ready'\n                }), '*')\n              })\n            }())\n          <\/script>\n\n          <style>${t}</style>\n        </head>\n        <body>\n          ${e}\n\n          \x3c!--\n            Jotted:\n            Empty script tag prevents malformed HTML from breaking the next script.\n          --\x3e\n          <script><\/script>\n          <script>${n}<\/script>\n        </body>\n      </html>\n    `}change(t,e){this.content[t.type]=t.content;var n=this.frameContent;if(this.frameContent=this.template(this.content.css,this.content.html,this.content.js),this.lastCallback=(()=>{this.lastCallback=(()=>{}),e(null,t)}),!0===t.forceRender||this.frameContent!==n)if(this.supportSrcdoc){var s=document.createElement("iframe");this.$resultFrame.parentNode.replaceChild(s,this.$resultFrame),this.$resultFrame=s,this.$resultFrame.contentWindow.document.open(),this.$resultFrame.contentWindow.document.write(this.frameContent),this.$resultFrame.contentWindow.document.close()}else{this.$resultFrame.setAttribute("data-srcdoc",this.frameContent);var i='javascript:window.frameElement.getAttribute("data-srcdoc");';this.$resultFrame.setAttribute("src",i),this.$resultFrame.contentWindow&&(this.$resultFrame.contentWindow.location=i)}else e(null,t)}domready(t){if(t.source===this.$resultFrame.contentWindow){var e={};try{e=JSON.parse(t.data)}catch(t){}"jotted-dom-ready"===e.type&&this.lastCallback()}}}}),t("skylark-jotted/plugins/scriptless",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{});e.on("change",this.change.bind(this)),this.runScriptTypes=["application/javascript","application/ecmascript","application/x-ecmascript","application/x-javascript","text/ecmascript","text/javascript","text/javascript1.0","text/javascript1.1","text/javascript1.2","text/javascript1.3","text/javascript1.4","text/javascript1.5","text/jscript","text/livescript","text/x-ecmascript","text/x-javascript"]}change(t,e){if("html"!==t.type)return e(null,t);var n=document.createElement("div");n.innerHTML=t.content;var s=null,i=n.querySelectorAll("script");for(let t=0;t<i.length;t++)(s=i[t].getAttribute("type"))&&-1===this.runScriptTypes.indexOf(s)||i[t].parentNode.removeChild(i[t]);t.content=n.innerHTML,e(null,t)}}}),t("skylark-jotted/plugins/ace",["../util"],function(t){"use strict";return class{constructor(e,n){var s;if(this.editor={},this.jotted=e,n=t.extend(n,{}),void 0!==window.ace){var i=e.$container.querySelectorAll(".jotted-editor");for(s=0;s<i.length;s++){let e=i[s].querySelector("textarea"),r=t.data(e,"jotted-type"),o=t.data(e,"jotted-file"),a=document.createElement("div");i[s].appendChild(a),this.editor[r]=window.ace.edit(a);let l=this.editor[r],c=t.extend(n);l.getSession().setMode("ace/mode/"+t.getMode(r,o)),l.getSession().setOptions(c),l.$blockScrolling=1/0}e.on("change",this.change.bind(this),1)}}editorChange(t){return()=>{this.jotted.trigger("change",t)}}change(t,e){var n=this.editor[t.type];t.aceEditor||(n.getSession().setValue(t.content),t.aceEditor=n,n.on("change",this.editorChange(t))),t.content=n.getValue(),e(null,t)}}}),t("skylark-jotted/plugins/codemirror",["../util"],function(t){"use strict";return class{constructor(e,n){var s;this.editor={},this.jotted=e;var i={html:"htmlmixed"};if(n=t.extend(n,{lineNumbers:!0}),void 0!==window.CodeMirror){var r=e.$container.querySelectorAll(".jotted-editor");for(s=0;s<r.length;s++){let e=r[s].querySelector("textarea"),o=t.data(e,"jotted-type"),a=t.data(e,"jotted-file");this.editor[o]=window.CodeMirror.fromTextArea(e,n),this.editor[o].setOption("mode",t.getMode(o,a,i))}e.on("change",this.change.bind(this),1)}}editorChange(t){return()=>{this.jotted.trigger("change",t)}}change(t,e){var n=this.editor[t.type];t.cmEditor||(n.setValue(t.content),t.cmEditor=n,n.on("change",this.editorChange(t))),t.content=n.getValue(),e(null,t)}}}),t("skylark-jotted/plugins/less",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{}),void 0!==window.less&&(e.$container.querySelector('a[data-jotted-type="css"]').innerHTML="Less",e.on("change",this.change.bind(this),20))}isLess(t){return"css"===t.type&&(-1!==t.file.indexOf(".less")||""===t.file)}change(t,e){this.isLess(t)?window.less.render(t.content,this.options,(n,s)=>{if(n)return e(n,t);t.content=s.css,e(null,t)}):e(null,t)}}}),t("skylark-jotted/plugins/coffeescript",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{}),void 0!==window.CoffeeScript&&(e.$container.querySelector('a[data-jotted-type="js"]').innerHTML="CoffeeScript",e.on("change",this.change.bind(this),20))}isCoffee(t){return"js"===t.type&&(-1!==t.file.indexOf(".coffee")||""===t.file)}change(t,e){if(this.isCoffee(t))try{t.content=window.CoffeeScript.compile(t.content)}catch(n){return e(n,t)}e(null,t)}}}),t("skylark-jotted/plugins/stylus",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{}),void 0!==window.stylus&&(e.$container.querySelector('a[data-jotted-type="css"]').innerHTML="Stylus",e.on("change",this.change.bind(this),20))}isStylus(t){return"css"===t.type&&(-1!==t.file.indexOf(".styl")||""===t.file)}change(t,e){this.isStylus(t)?window.stylus(t.content,this.options).render((n,s)=>{if(n)return e(n,t);t.content=s,e(null,t)}):e(null,t)}}}),t("skylark-jotted/plugins/babel",["../util"],function(t){"use strict";return class{constructor(e,n){if(this.options=t.extend(n,{}),void 0!==window.Babel)this.babel=window.Babel;else{if(void 0===window.babel)return;this.babel={transform:window.babel}}e.$container.querySelector('a[data-jotted-type="js"]').innerHTML="ES2015",e.on("change",this.change.bind(this),20)}change(t,e){if("js"===t.type){try{t.content=this.babel.transform(t.content,this.options).code}catch(n){return e(n,t)}e(null,t)}else e(null,t)}}}),t("skylark-jotted/plugins/markdown",["../util"],function(t){"use strict";return class{constructor(e,n){this.options=t.extend(n,{}),void 0!==window.marked&&(window.marked.setOptions(n),e.$container.querySelector('a[data-jotted-type="html"]').innerHTML="Markdown",e.on("change",this.change.bind(this),20))}change(t,e){if("html"===t.type){try{t.content=window.marked(t.content)}catch(n){return e(n,t)}e(null,t)}else e(null,t)}}}),t("skylark-jotted/plugins/console",["../util"],function(t){"use strict";return class{constructor(e,n){n=t.extend(n,{autoClear:!1});var s=`(${this.capture.toString()})();`,i=document.createElement("li");t.addClass(i,"jotted-nav-item jotted-nav-item-console"),i.innerHTML='<a href="#" data-jotted-type="console">JS Console</a>';var r=document.createElement("div");t.addClass(r,"jotted-pane jotted-pane-console"),r.innerHTML='\n      <div class="jotted-console-container">\n        <ul class="jotted-console-output"></ul>\n        <form class="jotted-console-input">\n          <input type="text">\n        </form>\n      </div>\n      <button class="jotted-button jotted-console-clear">Clear</button>\n    ',e.$container.appendChild(r),e.$container.querySelector(".jotted-nav").appendChild(i);var o=e.$container.querySelector(".jotted-console-container"),a=e.$container.querySelector(".jotted-console-output"),l=e.$container.querySelector(".jotted-console-input input"),c=e.$container.querySelector(".jotted-console-input"),u=e.$container.querySelector(".jotted-console-clear");c.addEventListener("submit",this.submit.bind(this)),l.addEventListener("keydown",this.history.bind(this)),u.addEventListener("click",this.clear.bind(this)),!0===n.autoClear&&e.on("change",this.autoClear.bind(this),29),e.on("change",this.change.bind(this),30),window.addEventListener("message",this.getMessage.bind(this)),this.$jottedContainer=e.$container,this.$container=o,this.$input=l,this.$output=a,this.history=[],this.historyIndex=0,this.logCaptureSnippet=s,this.contentCache={html:"",css:"",js:""},this.getIframe=this.getIframe.bind(this)}getIframe(){return this.$jottedContainer.querySelector(".jotted-pane-result iframe")}getMessage(t){if(t.source===this.getIframe().contentWindow){var e={};try{e=JSON.parse(t.data)}catch(t){}"jotted-console-log"===e.type&&this.log(e.message)}}autoClear(t,e){var n=t.content;"js"===t.type&&(n=n.replace(this.logCaptureSnippet,"")),!0!==t.forceRender&&this.contentCache[t.type]===n||this.clear(),this.contentCache[t.type]=n,e(null,t)}change(t,e){if("js"!==t.type)return e(null,t);-1===t.content.indexOf(this.logCaptureSnippet)&&(t.content=`${this.logCaptureSnippet}${t.content}`),e(null,t)}capture(){void 0!==window.console&&void 0!==window.console.log||(window.console={log:function(){}});var t=Function.prototype.bind.call(window.console.log,window.console);window.console.log=function(){[].slice.call(arguments).forEach(function(t){window.parent.postMessage(JSON.stringify({type:"jotted-console-log",message:t}),"*")}),t.apply(t,arguments)}}log(e="",n){var s=document.createElement("li");t.addClass(s,"jotted-console-log"),void 0!==n&&t.addClass(s,`jotted-console-log-${n}`),s.innerHTML=e,this.$output.appendChild(s)}submit(t){var e=this.$input.value.trim();if(""===e)return t.preventDefault();this.history.push(e),this.historyIndex=this.history.length,this.log(e,"history"),0!==e.indexOf("return")&&(e="return "+e);try{var n=this.getIframe().contentWindow.eval(`(function() {${e}})()`);this.log(n)}catch(t){this.log(t,"error")}this.$input.value="",this.$container.scrollTop=this.$container.scrollHeight,t.preventDefault()}clear(){this.$output.innerHTML=""}history(t){var e=!1,n=this.$input.selectionStart;38===t.keyCode&&0!==this.historyIndex&&0===n&&(this.historyIndex--,e=!0),40===t.keyCode&&this.historyIndex!==this.history.length-1&&n===this.$input.value.length&&(this.historyIndex++,e=!0),e&&(this.$input.value=this.history[this.historyIndex])}}}),t("skylark-jotted/plugins/play",["../util"],function(t){"use strict";return class{constructor(e,n){var s={};!1===(n=t.extend(n,{firstRun:!0})).firstRun&&(s={html:{type:"html",content:""},css:{type:"css",content:""},js:{type:"js",content:""}});var i=document.createElement("button");i.className="jotted-button jotted-button-play",i.innerHTML="Run",e.$container.appendChild(i),i.addEventListener("click",this.run.bind(this)),e.on("change",this.change.bind(this),10),this.cache=s,this.code={},this.jotted=e}change(e,n){this.code[e.type]=t.extend(e),void 0!==this.cache[e.type]?(n(null,this.cache[e.type]),this.cache[e.type].forceRender=null):(this.cache[e.type]=t.extend(e),n(null,e))}run(){for(let e in this.code)this.cache[e]=t.extend(this.code[e],{forceRender:!0}),this.jotted.trigger("change",this.cache[e])}}}),t("skylark-jotted/plugins/pen",[],function(){"use strict";return class{constructor(t,e){let n={html:{title:"HTML",classChecker:"jotted-has-html"},css:{title:"CSS",classChecker:"jotted-has-css"},js:{title:"JavaScript",classChecker:"jotted-has-js"},console:{title:"Console",classChecker:"jotted-plugin-console"}},s=[];for(let e in n)t.$container.classList.contains(n[e].classChecker)&&s.push(t.$container.querySelector(`.jotted-pane-${e}`));this.resizablePanes=[];for(let e=0;e<s.length;e++){let i;for(let t=0;t<s[e].classList.length;t++)if(-1!==s[e].classList[t].indexOf("jotted-pane-")){i=s[e].classList[t].replace("jotted-pane-","");break}if(!i)continue;let r={container:s[e],expander:void 0};this.resizablePanes.push(r);let o=document.createElement("div");o.classList.add("jotted-pane-title"),o.innerHTML=n[i].title||i;let a=s[e].firstElementChild;a.insertBefore(o,a.firstChild),e>0&&(r.expander=document.createElement("div"),r.expander.classList.add("jotted-plugin-pen-expander"),r.expander.addEventListener("mousedown",this.startExpand.bind(this,t)),a.insertBefore(r.expander,o))}}startExpand(t,e){let n=this.resizablePanes.filter(t=>t.expander===e.target).shift(),s=this.resizablePanes[this.resizablePanes.indexOf(n)-1],i=100/parseInt(window.getComputedStyle(n.container.parentNode).width,10);n.container.parentNode.style.display="none",n.startX=e.clientX,n.startWidth=parseFloat(window.getComputedStyle(n.container).width,10),s.startWidth=parseFloat(window.getComputedStyle(s.container).width,10),n.container.parentNode.style.display="",n.mousemove=this.doDrag.bind(this,n,s,i),n.mouseup=this.stopDrag.bind(this,n),document.addEventListener("mousemove",n.mousemove,!1),document.addEventListener("mouseup",n.mouseup,!1)}doDrag(t,e,n,s){let i=e.startWidth+(s.clientX-t.startX)*n,r=t.startWidth-(s.clientX-t.startX)*n;i>=10&&r>=10&&(t.container.style.maxWidth="none",e.container.style.maxWidth="none",e.container.style.width=`${i}%`,t.container.style.width=`${r}%`)}stopDrag(t,e){document.removeEventListener("mousemove",t.mousemove,!1),document.removeEventListener("mouseup",t.mouseup,!1)}}}),t("skylark-jotted/bundle-plugins",["./plugins/render","./plugins/scriptless","./plugins/ace","./plugins/codemirror","./plugins/less","./plugins/coffeescript","./plugins/stylus","./plugins/babel","./plugins/markdown","./plugins/console","./plugins/play","./plugins/pen"],function(t,e,n,s,i,r,o,a,l,c,u,d){"use strict";return function(h){h.plugin("render",t),h.plugin("scriptless",e),h.plugin("ace",n),h.plugin("codemirror",s),h.plugin("less",i),h.plugin("coffeescript",r),h.plugin("stylus",o),h.plugin("babel",a),h.plugin("markdown",l),h.plugin("console",c),h.plugin("play",u),h.plugin("pen",d)}}),t("skylark-jotted/Jotted",["skylark-langx/skylark","./util","./template","./plugin","./pubsoup","./bundle-plugins"],function(t,e,n,s,i,r){"use strict";class o{constructor(t,r){if(!t)throw new Error("Can't find Jotted container.");var o={};this._get=function(t){return o[t]},this._set=function(t,e){return o[t]=e,o[t]};var a=this._set("options",e.extend(r,{files:[],showBlank:!1,runScripts:!0,pane:"result",debounce:250,plugins:[]}));a.plugins.push("render"),!1===a.runScripts&&a.plugins.push("scriptless"),this._set("cachedContent",{html:null,css:null,js:null});var l=this._set("pubsoup",new i);this._set("trigger",this.trigger()),this._set("on",function(){l.subscribe.apply(l,arguments)}),this._set("off",function(){l.unsubscribe.apply(l,arguments)});var c=this._set("done",function(){l.done.apply(l,arguments)});c("change",this.errors.bind(this));var u=this._set("$container",t);u.innerHTML=n.container(),e.addClass(u,n.containerClass());var d=this._set("paneActive",a.pane);e.addClass(u,n.paneActiveClass(d)),this._set("$status",{});for(let t of["html","css","js"])this.markup(t);u.addEventListener("keyup",e.debounce(this.change.bind(this),a.debounce)),u.addEventListener("change",e.debounce(this.change.bind(this),a.debounce)),u.addEventListener("click",this.pane.bind(this)),this.$container=this._get("$container"),this.on=this._get("on"),this.off=this._get("off"),this.done=this._get("done"),this.trigger=this._get("trigger"),this.paneActive=this._get("paneActive"),this._set("plugins",{}),s.init.call(this);for(let t of["html","css","js"])this.load(t);if(a.showBlank)for(let t of["html","css","js"])e.addClass(u,n.hasFileClass(t))}findFile(t){var e=this._get("options");for(let n in e.files){let s=e.files[n];if(s.type===t)return s}return{}}markup(t){var s=this._get("$container"),i=s.querySelector(`.jotted-pane-${t}`),r=this.findFile(t),o=document.createElement("div");o.innerHTML=n.editorContent(t,r.url),o.className=n.editorClass(t),i.appendChild(o),this._get("$status")[t]=i.querySelector(".jotted-status"),void 0===r.url&&void 0===r.content||e.addClass(s,n.hasFileClass(t))}load(t){var s=this.findFile(t),i=this._get("$container").querySelector(`.jotted-pane-${t} textarea`);void 0!==s.content?this.setValue(i,s.content):void 0!==s.url?(this.status("loading",[n.statusLoading(s.url)],{type:t,file:s}),e.fetch(s.url,(e,s)=>{e?this.status("error",[n.statusFetchError(e)],{type:t}):(this.clearStatus("loading",{type:t}),this.setValue(i,s))})):this.setValue(i,"")}setValue(t,e){t.value=e,this.change({target:t})}change(t){var n=e.data(t.target,"jotted-type");if(n){var s=this._get("cachedContent");s[n]!==t.target.value&&(s[n]=t.target.value,this.trigger("change",{type:n,file:e.data(t.target,"jotted-file"),content:s[n]}))}}errors(t,e){this.status("error",t,e)}pane(t){if(e.data(t.target,"jotted-type")){var s=this._get("$container"),i=this._get("paneActive");e.removeClass(s,n.paneActiveClass(i)),i=this._set("paneActive",e.data(t.target,"jotted-type")),e.addClass(s,n.paneActiveClass(i)),t.preventDefault()}}status(t="error",s=[],i={}){if(!s.length)return this.clearStatus(t,i);var r=this._get("$status");e.addClass(r[i.type],n.statusClass(t)),e.addClass(this._get("$container"),n.statusActiveClass(i.type));var o="";s.forEach(function(t){o+=n.statusMessage(t)}),r[i.type].innerHTML=o}clearStatus(t,s){var i=this._get("$status");e.removeClass(i[s.type],n.statusClass(t)),e.removeClass(this._get("$container"),n.statusActiveClass(s.type)),i[s.type].innerHTML=""}trigger(){var t=this._get("options"),e=this._get("pubsoup");if(!1===t.debounce)return function(){e.publish.apply(e,arguments)};var n={},s={};return function(i,{type:r="default"}={}){n[r]?s[r]=!0:e.publish.apply(e,arguments),clearTimeout(n[r]),n[r]=setTimeout(()=>{s[r]&&e.publish.apply(e,arguments),s[r]=null,n[r]=null},t.debounce)}}}return o.plugin=function(){return s.register.apply(this,arguments)},r(o),t.attach("itg.Jotted",o)}),t("skylark-jotted/main",["./Jotted"],function(t){return t}),t("skylark-jotted",["skylark-jotted/main"],function(t){return t})}(n),!i){var a=s("skylark-langx/skylark");r?module.exports=a:e.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-jotted-all.js.map
